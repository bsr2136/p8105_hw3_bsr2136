p8105\_hw3\_bsr2136
================
Barik Rajpal
10/10/2019

## Problem 0

``` r
dir.create("files_for_hw3")
```

## Problem 1

### Describing the dataset

``` r
library(p8105.datasets)
data("instacart")

## The number of rows in the dataset is
nrow(instacart)
```

    ## [1] 1384617

``` r
## The number of columns in the dataset is
ncol(instacart)
```

    ## [1] 15

``` r
## The dataset has identifying information such as order, product, and user.
## For example, The number of unique orders in the dataset is
length(unique(pull(instacart,order_id)))
```

    ## [1] 131209

``` r
## Which is equal to the number of unique users
length(unique(pull(instacart,user_id)))
```

    ## [1] 131209

``` r
## And the number of unique products is
length(unique(pull(instacart,product_id)))
```

    ## [1] 39123

``` r
## The dataset also gives information such as aisle and department of the
## product ordered. For example, The departments are
unique(pull(instacart,department))
```

    ##  [1] "dairy eggs"      "produce"         "canned goods"   
    ##  [4] "beverages"       "deli"            "snacks"         
    ##  [7] "pantry"          "frozen"          "meat seafood"   
    ## [10] "household"       "bakery"          "personal care"  
    ## [13] "dry goods pasta" "babies"          "missing"        
    ## [16] "other"           "breakfast"       "international"  
    ## [19] "alcohol"         "bulk"            "pets"

``` r
## The dataset also gives the hour of day that the order was made.
## For example, the most common hour at which an order was made is
instacart %>% group_by(order_hour_of_day) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  .[1,1]
```

    ## # A tibble: 1 x 1
    ##   order_hour_of_day
    ##               <int>
    ## 1                14

### Answering prompts about the dataset

#### 1\. How many aisles are there, and which aisles are the most items ordered from?

``` r
## The number of aisles are
length(unique(pull(instacart,aisle)))
```

    ## [1] 134

``` r
## And the aisles that the most items are ordered from are
instacart %>% group_by(aisle) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  head()
```

    ## # A tibble: 6 x 2
    ##   aisle                              n
    ##   <chr>                          <int>
    ## 1 fresh vegetables              150609
    ## 2 fresh fruits                  150473
    ## 3 packaged vegetables fruits     78493
    ## 4 yogurt                         55240
    ## 5 packaged cheese                41699
    ## 6 water seltzer sparkling water  36617

There are 134 aisles total, and the 6 aisles that foods are most
commonly ordered from are fresh vegetables, fresh fruits, packaged
vegetables fruits, yogurt, packaged cheese, and water seltzer sparkling
water. Among these 6, the top 2, fresh vegetables and fresh fruit,
receive far more orders than the other 4 (almost 2 times the 3rd ranked
aisle, packaged vegetables
fruits)

#### 2\. Make a plot that shows the number of items ordered in each aisle, limiting this to aisles with more than 10000 items ordered. Arrange aisles sensibly, and organize your plot so others can read it.

``` r
aisle_tbl <- instacart %>% 
  group_by(aisle) %>%
  summarise(n = n()) %>%
  filter(n>=10000) %>%
  arrange(n)

aisle_tbl %>%
  mutate(
    aisle = factor(pull(aisle_tbl,aisle),
                levels = pull(aisle_tbl,aisle)[order(pull(aisle_tbl,n))])) %>% 
  ggplot(aes(x=aisle,y=n)) + 
  geom_bar(stat = "identity") + 
  coord_flip() + xlab("Aisle") + ylab("Number of Items Ordered")
```

![](p8105_hw3_bsr2136_files/figure-gfm/Problem%201.2-1.png)<!-- -->

As also seen in the previous question, fresh vegetables and fresh fruits
are ordered from far more than any other aisle. While there is a steep
drop in number of items ordered after the highest 2 aisles, then a few
more moderate drops over the next few aisles, the rate of decay slows
greaty and from the eggs aisle to the butter aisle, (which looks to be
~25 aisles) there is a very small difference in the number of items
ordered per
aisle.

#### 3\. Make a table showing the three most popular items in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”. Include the number of times each item is ordered in your table.

``` r
baking <- instacart %>%
  filter(aisle == "baking ingredients") %>%
  group_by(aisle,product_name) %>%
  summarise(number_of_times_ordered = n()) %>%
  arrange(desc(number_of_times_ordered)) %>%
  head(3)

dog_food <- instacart %>%
  filter(aisle == "dog food care") %>%
  group_by(aisle,product_name) %>%
  summarise(number_of_times_ordered = n()) %>%
  arrange(desc(number_of_times_ordered)) %>%
  head(3)

pack_veg <- instacart %>%
  filter(aisle == "packaged vegetables fruits") %>%
  group_by(aisle,product_name) %>%
  summarise(number_of_times_ordered = n()) %>%
  arrange(desc(number_of_times_ordered)) %>%
  head(3)

rbind(baking,dog_food,pack_veg) %>%
  knitr::kable()
```

| aisle                      | product\_name                                 | number\_of\_times\_ordered |
| :------------------------- | :-------------------------------------------- | -------------------------: |
| baking ingredients         | Light Brown Sugar                             |                        499 |
| baking ingredients         | Pure Baking Soda                              |                        387 |
| baking ingredients         | Cane Sugar                                    |                        336 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |                         30 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |                         28 |
| dog food care              | Small Dog Biscuits                            |                         26 |
| packaged vegetables fruits | Organic Baby Spinach                          |                       9784 |
| packaged vegetables fruits | Organic Raspberries                           |                       5546 |
| packaged vegetables fruits | Organic Blueberries                           |                       4966 |

In addition to giving information about what are the 3 most popular
items in each of the three aisles, this table gives very clear
information on how popular the aisles are as well. The packaged
vegetables fruits aisle is ordered from far more than the baking
ingredients aisle, which is ordered from far more than the dog food care
aisle.

#### 4\. Make a table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week; format this table for human readers (i.e. produce a 2 x 7 table).

``` r
day_of_week <- instacart %>%
  filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>%
  group_by(product_name,order_dow) %>%
  summarise(mean_hour = mean(order_hour_of_day)) %>%
  pivot_wider(names_from = order_dow,
              values_from = mean_hour)

names(day_of_week)[2:8] <- c("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday")

knitr::kable(day_of_week)
```

| product\_name    |   Sunday |   Monday |  Tuesday | Wednesday | Thursday |   Friday | Saturday |
| :--------------- | -------: | -------: | -------: | --------: | -------: | -------: | -------: |
| Coffee Ice Cream | 13.77419 | 14.31579 | 15.38095 |  15.31818 | 15.21739 | 12.26316 | 13.83333 |
| Pink Lady Apples | 13.44118 | 11.36000 | 11.70213 |  14.25000 | 11.55172 | 12.78431 | 11.93750 |

The mean time at which Coffee Ice Cream is ordered is between 1 and 2 on
the weekend, between 3 and 4 from Tuesday through Thursday. Throughout
the week, the mean time is between 12 and 4.

The mean time at which Pink Lady Apples are ordered is between 11 and 12
Monday, Tuesday, Thursday, and Saturday, and between 11 and 230 through
the week.

## Problem 2

### Data Loading and Cleaning

``` r
library(p8105.datasets)
data("brfss_smart2010")

unique(pull(brfss_smart2010,Locationabbr))
```

    ##  [1] "AL" "AZ" "AR" "CA" "CO" "CT" "DE" "DC" "FL" "GA" "HI" "ID" "IL" "IN"
    ## [15] "IA" "KS" "KY" "LA" "ME" "MD" "MA" "MI" "MN" "MO" "MS" "MT" "NE" "NV"
    ## [29] "NH" "NJ" "NM" "NY" "NC" "OH" "ND" "OK" "OR" "PA" "RI" "SC" "SD" "TN"
    ## [43] "TX" "UT" "VT" "WA" "WI" "WV" "WY" "AK" "VA"

``` r
## This is just state, so I'm going to call it that

unique(pull(brfss_smart2010,Locationdesc))
```

    ##   [1] "AL - Jefferson County"            
    ##   [2] "AL - Mobile County"               
    ##   [3] "AL - Tuscaloosa County"           
    ##   [4] "AZ - Maricopa County"             
    ##   [5] "AZ - Pinal County"                
    ##   [6] "AZ - Pima County"                 
    ##   [7] "AR - Benton County"               
    ##   [8] "AR - Pulaski County"              
    ##   [9] "AR - Washington County"           
    ##  [10] "CA - Alameda County"              
    ##  [11] "CA - Los Angeles County"          
    ##  [12] "CA - Contra Costa County"         
    ##  [13] "CA - Orange County"               
    ##  [14] "CA - Placer County"               
    ##  [15] "CA - Riverside County"            
    ##  [16] "CA - Sacramento County"           
    ##  [17] "CA - San Bernardino County"       
    ##  [18] "CA - San Diego County"            
    ##  [19] "CA - San Francisco County"        
    ##  [20] "CA - San Mateo County"            
    ##  [21] "CA - Santa Clara County"          
    ##  [22] "CO - Adams County"                
    ##  [23] "CO - Arapahoe County"             
    ##  [24] "CO - Douglas County"              
    ##  [25] "CO - Denver County"               
    ##  [26] "CO - El Paso County"              
    ##  [27] "CO - Jefferson County"            
    ##  [28] "CO - Larimer County"              
    ##  [29] "CT - Fairfield County"            
    ##  [30] "CT - Tolland County"              
    ##  [31] "CT - Hartford County"             
    ##  [32] "CT - Middlesex County"            
    ##  [33] "CT - New Haven County"            
    ##  [34] "DE - Kent County"                 
    ##  [35] "DE - New Castle County"           
    ##  [36] "DE - Sussex County"               
    ##  [37] "DC - District of Columbia"        
    ##  [38] "FL - Alachua County"              
    ##  [39] "FL - Baker County"                
    ##  [40] "FL - Bay County"                  
    ##  [41] "FL - Brevard County"              
    ##  [42] "FL - Broward County"              
    ##  [43] "FL - Clay County"                 
    ##  [44] "FL - Citrus County"               
    ##  [45] "FL - Collier County"              
    ##  [46] "FL - Columbia County"             
    ##  [47] "FL - Escambia County"             
    ##  [48] "FL - Duval County"                
    ##  [49] "FL - DeSoto County"               
    ##  [50] "FL - Hernando County"             
    ##  [51] "FL - Gadsden County"              
    ##  [52] "FL - Gilchrist County"            
    ##  [53] "FL - Hardee County"               
    ##  [54] "FL - Highlands County"            
    ##  [55] "FL - Hillsborough County"         
    ##  [56] "FL - Manatee County"              
    ##  [57] "FL - Jefferson County"            
    ##  [58] "FL - Lake County"                 
    ##  [59] "FL - Leon County"                 
    ##  [60] "FL - Lee County"                  
    ##  [61] "FL - Marion County"               
    ##  [62] "FL - Martin County"               
    ##  [63] "FL - Miami-Dade County"           
    ##  [64] "FL - Monroe County"               
    ##  [65] "FL - Nassau County"               
    ##  [66] "FL - Orange County"               
    ##  [67] "FL - Osceola County"              
    ##  [68] "FL - Palm Beach County"           
    ##  [69] "FL - Pinellas County"             
    ##  [70] "FL - Pasco County"                
    ##  [71] "FL - Polk County"                 
    ##  [72] "FL - St. Johns County"            
    ##  [73] "FL - St. Lucie County"            
    ##  [74] "FL - Volusia County"              
    ##  [75] "FL - Santa Rosa County"           
    ##  [76] "FL - Sarasota County"             
    ##  [77] "FL - Seminole County"             
    ##  [78] "FL - Wakulla County"              
    ##  [79] "GA - Cobb County"                 
    ##  [80] "HI - Honolulu County"             
    ##  [81] "GA - DeKalb County"               
    ##  [82] "GA - Fulton County"               
    ##  [83] "HI - Hawaii County"               
    ##  [84] "GA - Gwinnett County"             
    ##  [85] "HI - Kauai County"                
    ##  [86] "ID - Bonneville County"           
    ##  [87] "HI - Maui County"                 
    ##  [88] "ID - Ada County"                  
    ##  [89] "ID - Canyon County"               
    ##  [90] "ID - Kootenai County"             
    ##  [91] "ID - Nez Perce County"            
    ##  [92] "ID - Twin Falls County"           
    ##  [93] "IL - Cook County"                 
    ##  [94] "IL - DuPage County"               
    ##  [95] "IN - Allen County"                
    ##  [96] "IN - Marion County"               
    ##  [97] "IN - Lake County"                 
    ##  [98] "IA - Linn County"                 
    ##  [99] "KS - Sedgwick County"             
    ## [100] "IA - Polk County"                 
    ## [101] "KS - Johnson County"              
    ## [102] "KS - Shawnee County"              
    ## [103] "KY - Jefferson County"            
    ## [104] "KS - Wyandotte County"            
    ## [105] "LA - East Baton Rouge Parish"     
    ## [106] "LA - Caddo Parish"                
    ## [107] "LA - Jefferson Parish"            
    ## [108] "LA - Orleans Parish"              
    ## [109] "LA - St. Tammany Parish"          
    ## [110] "ME - Androscoggin County"         
    ## [111] "ME - Cumberland County"           
    ## [112] "ME - Kennebec County"             
    ## [113] "MD - Baltimore County"            
    ## [114] "ME - Penobscot County"            
    ## [115] "ME - Sagadahoc County"            
    ## [116] "ME - York County"                 
    ## [117] "MD - Anne Arundel County"         
    ## [118] "MD - Cecil County"                
    ## [119] "MD - Charles County"              
    ## [120] "MD - Frederick County"            
    ## [121] "MD - Harford County"              
    ## [122] "MD - Prince George's County"      
    ## [123] "MD - Howard County"               
    ## [124] "MD - Montgomery County"           
    ## [125] "MD - Queen Anne's County"         
    ## [126] "MD - Baltimore city"              
    ## [127] "MD - Washington County"           
    ## [128] "MA - Bristol County"              
    ## [129] "MA - Essex County"                
    ## [130] "MA - Hampden County"              
    ## [131] "MA - Hampshire County"            
    ## [132] "MA - Middlesex County"            
    ## [133] "MA - Norfolk County"              
    ## [134] "MA - Plymouth County"             
    ## [135] "MA - Suffolk County"              
    ## [136] "MA - Worcester County"            
    ## [137] "MI - Oakland County"              
    ## [138] "MI - Kent County"                 
    ## [139] "MI - Macomb County"               
    ## [140] "MI - Wayne County"                
    ## [141] "MN - Anoka County"                
    ## [142] "MN - Dakota County"               
    ## [143] "MN - Hennepin County"             
    ## [144] "MN - Ramsey County"               
    ## [145] "MN - Washington County"           
    ## [146] "MO - St. Louis County"            
    ## [147] "MS - DeSoto County"               
    ## [148] "MS - Hinds County"                
    ## [149] "MO - Jackson County"              
    ## [150] "MO - St. Louis city"              
    ## [151] "MT - Flathead County"             
    ## [152] "MT - Lewis and Clark County"      
    ## [153] "MT - Yellowstone County"          
    ## [154] "NE - Adams County"                
    ## [155] "NE - Dakota County"               
    ## [156] "NE - Douglas County"              
    ## [157] "NE - Hall County"                 
    ## [158] "NE - Lincoln County"              
    ## [159] "NE - Lancaster County"            
    ## [160] "NE - Madison County"              
    ## [161] "NE - Sarpy County"                
    ## [162] "NE - Scotts Bluff County"         
    ## [163] "NE - Seward County"               
    ## [164] "NV - Clark County"                
    ## [165] "NV - Washoe County"               
    ## [166] "NH - Grafton County"              
    ## [167] "NH - Merrimack County"            
    ## [168] "NH - Hillsborough County"         
    ## [169] "NH - Strafford County"            
    ## [170] "NH - Rockingham County"           
    ## [171] "NJ - Atlantic County"             
    ## [172] "NJ - Bergen County"               
    ## [173] "NJ - Burlington County"           
    ## [174] "NJ - Camden County"               
    ## [175] "NJ - Cape May County"             
    ## [176] "NJ - Essex County"                
    ## [177] "NJ - Gloucester County"           
    ## [178] "NJ - Hunterdon County"            
    ## [179] "NJ - Hudson County"               
    ## [180] "NJ - Mercer County"               
    ## [181] "NJ - Middlesex County"            
    ## [182] "NJ - Monmouth County"             
    ## [183] "NJ - Morris County"               
    ## [184] "NJ - Ocean County"                
    ## [185] "NJ - Somerset County"             
    ## [186] "NJ - Passaic County"              
    ## [187] "NJ - Union County"                
    ## [188] "NJ - Sussex County"               
    ## [189] "NJ - Warren County"               
    ## [190] "NM - Bernalillo County"           
    ## [191] "NM - Dona Ana County"             
    ## [192] "NM - Sandoval County"             
    ## [193] "NM - San Juan County"             
    ## [194] "NM - Valencia County"             
    ## [195] "NM - Santa Fe County"             
    ## [196] "NY - Bronx County"                
    ## [197] "NY - Erie County"                 
    ## [198] "NY - Kings County"                
    ## [199] "NY - Monroe County"               
    ## [200] "NY - New York County"             
    ## [201] "NY - Nassau County"               
    ## [202] "NY - Queens County"               
    ## [203] "NY - Suffolk County"              
    ## [204] "NY - Westchester County"          
    ## [205] "NC - Cabarrus County"             
    ## [206] "NC - Buncombe County"             
    ## [207] "NC - Catawba County"              
    ## [208] "NC - Durham County"               
    ## [209] "NC - Orange County"               
    ## [210] "NC - Gaston County"               
    ## [211] "NC - Guilford County"             
    ## [212] "NC - Johnston County"             
    ## [213] "NC - Mecklenburg County"          
    ## [214] "NC - Randolph County"             
    ## [215] "OH - Cuyahoga County"             
    ## [216] "NC - Union County"                
    ## [217] "NC - Wake County"                 
    ## [218] "ND - Burleigh County"             
    ## [219] "ND - Ward County"                 
    ## [220] "ND - Cass County"                 
    ## [221] "OH - Franklin County"             
    ## [222] "OH - Lucas County"                
    ## [223] "OH - Hamilton County"             
    ## [224] "OH - Mahoning County"             
    ## [225] "OH - Montgomery County"           
    ## [226] "OH - Summit County"               
    ## [227] "OH - Stark County"                
    ## [228] "OK - Cleveland County"            
    ## [229] "OK - Oklahoma County"             
    ## [230] "OK - Tulsa County"                
    ## [231] "OR - Clackamas County"            
    ## [232] "OR - Lane County"                 
    ## [233] "OR - Multnomah County"            
    ## [234] "PA - Luzerne County"              
    ## [235] "OR - Washington County"           
    ## [236] "PA - Allegheny County"            
    ## [237] "PA - Lehigh County"               
    ## [238] "PA - Montgomery County"           
    ## [239] "PA - Northampton County"          
    ## [240] "PA - Philadelphia County"         
    ## [241] "RI - Bristol County"              
    ## [242] "PA - Westmoreland County"         
    ## [243] "RI - Kent County"                 
    ## [244] "RI - Newport County"              
    ## [245] "RI - Providence County"           
    ## [246] "RI - Washington County"           
    ## [247] "SC - Aiken County"                
    ## [248] "SC - Beaufort County"             
    ## [249] "SC - Horry County"                
    ## [250] "SC - Charleston County"           
    ## [251] "SC - Berkeley County"             
    ## [252] "SC - Greenville County"           
    ## [253] "SC - Richland County"             
    ## [254] "SD - Minnehaha County"            
    ## [255] "SD - Pennington County"           
    ## [256] "TN - Davidson County"             
    ## [257] "TN - Hamilton County"             
    ## [258] "TN - Knox County"                 
    ## [259] "TN - Shelby County"               
    ## [260] "TN - Sullivan County"             
    ## [261] "TX - Dallas County"               
    ## [262] "TX - Bexar County"                
    ## [263] "TX - El Paso County"              
    ## [264] "TX - Harris County"               
    ## [265] "TX - Fort Bend County"            
    ## [266] "TX - Hidalgo County"              
    ## [267] "TX - Lubbock County"              
    ## [268] "TX - Midland County"              
    ## [269] "TX - Potter County"               
    ## [270] "TX - Tarrant County"              
    ## [271] "TX - Randall County"              
    ## [272] "TX - Smith County"                
    ## [273] "TX - Travis County"               
    ## [274] "TX - Val Verde County"            
    ## [275] "TX - Webb County"                 
    ## [276] "TX - Wichita County"              
    ## [277] "UT - Davis County"                
    ## [278] "UT - Salt Lake County"            
    ## [279] "UT - Summit County"               
    ## [280] "UT - Tooele County"               
    ## [281] "UT - Utah County"                 
    ## [282] "UT - Weber County"                
    ## [283] "VT - Chittenden County"           
    ## [284] "VT - Franklin County"             
    ## [285] "VT - Rutland County"              
    ## [286] "VT - Orange County"               
    ## [287] "VT - Washington County"           
    ## [288] "VT - Windsor County"              
    ## [289] "WA - Franklin County"             
    ## [290] "WA - Benton County"               
    ## [291] "WA - Clark County"                
    ## [292] "WA - King County"                 
    ## [293] "WA - Kitsap County"               
    ## [294] "WA - Pierce County"               
    ## [295] "WA - Snohomish County"            
    ## [296] "WA - Spokane County"              
    ## [297] "WA - Thurston County"             
    ## [298] "WI - Milwaukee County"            
    ## [299] "WA - Yakima County"               
    ## [300] "WV - Kanawha County"              
    ## [301] "WY - Natrona County"              
    ## [302] "WY - Laramie County"              
    ## [303] "AK - Anchorage Municipality"      
    ## [304] "CO - Weld County"                 
    ## [305] "GA - Clayton County"              
    ## [306] "IL - Lake County"                 
    ## [307] "IL - Will County"                 
    ## [308] "IN - Vanderburgh County"          
    ## [309] "IA - Scott County"                
    ## [310] "KS - Leavenworth County"          
    ## [311] "KS - Butler County"               
    ## [312] "KS - Douglas County"              
    ## [313] "KS - Riley County"                
    ## [314] "LA - Calcasieu Parish"            
    ## [315] "LA - Terrebonne Parish"           
    ## [316] "LA - Rapides Parish"              
    ## [317] "MS - George County"               
    ## [318] "MS - Hancock County"              
    ## [319] "MS - Harrison County"             
    ## [320] "MS - Jackson County"              
    ## [321] "MS - Rankin County"               
    ## [322] "MS - Stone County"                
    ## [323] "MT - Gallatin County"             
    ## [324] "MT - Silver Bow County"           
    ## [325] "NM - McKinley County"             
    ## [326] "NC - Cumberland County"           
    ## [327] "NC - Henderson County"            
    ## [328] "NC - New Hanover County"          
    ## [329] "OK - Canadian County"             
    ## [330] "PA - Delaware County"             
    ## [331] "PA - Bucks County"                
    ## [332] "PA - Fayette County"              
    ## [333] "UT - Wasatch County"              
    ## [334] "TX - Williamson County"           
    ## [335] "WA - Chelan County"               
    ## [336] "WA - Douglas County"              
    ## [337] "WA - Skamania County"             
    ## [338] "WY - Fremont County"              
    ## [339] "AL - Montgomery County"           
    ## [340] "AK - Fairbanks North Star Borough"
    ## [341] "AZ - Cochise County"              
    ## [342] "AZ - Yuma County"                 
    ## [343] "CO - Boulder County"              
    ## [344] "MD - Calvert County"              
    ## [345] "MA - Barnstable County"           
    ## [346] "MA - Franklin County"             
    ## [347] "NH - Coos County"                 
    ## [348] "NC - Forsyth County"              
    ## [349] "SC - Laurens County"              
    ## [350] "SC - Orangeburg County"           
    ## [351] "WY - Campbell County"             
    ## [352] "WY - Sweetwater County"           
    ## [353] "AZ - Santa Cruz County"           
    ## [354] "CT - New London County"           
    ## [355] "FL - Flagler County"              
    ## [356] "FL - Hendry County"               
    ## [357] "FL - Okeechobee County"           
    ## [358] "OH - Licking County"              
    ## [359] "SC - Dorchester County"           
    ## [360] "SC - Lexington County"            
    ## [361] "SC - York County"                 
    ## [362] "TX - Cameron County"              
    ## [363] "TX - Collin County"               
    ## [364] "TX - Denton County"               
    ## [365] "VA - Fairfax County"              
    ## [366] "VA - Arlington County"            
    ## [367] "VA - Prince William County"       
    ## [368] "VA - Alexandria city"             
    ## [369] "WA - Whatcom County"              
    ## [370] "MD - Carroll County"              
    ## [371] "MT - Cascade County"              
    ## [372] "MT - Missoula County"             
    ## [373] "NH - Cheshire County"             
    ## [374] "OH - Lorain County"               
    ## [375] "WA - Asotin County"               
    ## [376] "MI - Genesee County"              
    ## [377] "MI - Ingham County"               
    ## [378] "OK - Carter County"               
    ## [379] "OK - Cherokee County"             
    ## [380] "OK - Comanche County"             
    ## [381] "OK - Ottawa County"               
    ## [382] "OK - Garfield County"             
    ## [383] "OK - Pittsburg County"            
    ## [384] "OK - Pottawatomie County"         
    ## [385] "OK - Rogers County"               
    ## [386] "OK - Sequoyah County"             
    ## [387] "OK - Wagoner County"              
    ## [388] "OK - Washington County"           
    ## [389] "OR - Jackson County"              
    ## [390] "OR - Marion County"               
    ## [391] "OR - Yamhill County"              
    ## [392] "SC - Spartanburg County"          
    ## [393] "CO - Teller County"               
    ## [394] "LA - Ouachita Parish"             
    ## [395] "TN - Stewart County"              
    ## [396] "TN - Montgomery County"           
    ## [397] "GA - Richmond County"             
    ## [398] "CT - Windham County"              
    ## [399] "PA - Chester County"              
    ## [400] "PA - Armstrong County"            
    ## [401] "PA - Franklin County"             
    ## [402] "PA - Lancaster County"            
    ## [403] "SC - Darlington County"           
    ## [404] "SC - Florence County"

``` r
## This is just county, so I'm going to call it that

names(brfss_smart2010)[2:3] = c("state","county")

brfss <- brfss_smart2010 %>%
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>%
  filter(response %in% c("Poor","Fair","Good","Very good","Excellent")) %>%
  mutate(response = factor(response, levels = c("Poor","Fair","Good","Very good","Excellent")))

unique(pull(brfss,data_value_unit))
```

    ## [1] "%"

``` r
## So I'm going to get rid of that column and rename data_value to indicate that it is a %
unique(pull(brfss,location_id))
```

    ## [1] NA

``` r
unique(pull(brfss,data_value_footnote_symbol))
```

    ## [1] NA  "*"

``` r
## And get rid of those as well

names(brfss)[9] = "percent_responded"

brfss <- brfss %>%
  select(-topic,-data_value_unit,-location_id,-data_value_footnote_symbol)
```

### Answering questions about the dataset

#### 1\. In 2002, which states were observed at 7 or more locations? What about in 2010?

``` r
brfss %>%
  filter(year==2002) %>%
  distinct(state,county) %>%
  group_by(state) %>%
  summarise(number_of_locations = n()) %>%
  filter(number_of_locations >=7)
```

    ## # A tibble: 6 x 2
    ##   state number_of_locations
    ##   <chr>               <int>
    ## 1 CT                      7
    ## 2 FL                      7
    ## 3 MA                      8
    ## 4 NC                      7
    ## 5 NJ                      8
    ## 6 PA                     10

``` r
brfss %>%
  filter(year==2010) %>%
  distinct(state,county) %>%
  group_by(state) %>%
  summarise(number_of_locations = n()) %>%
  filter(number_of_locations >=7)
```

    ## # A tibble: 14 x 2
    ##    state number_of_locations
    ##    <chr>               <int>
    ##  1 CA                     12
    ##  2 CO                      7
    ##  3 FL                     41
    ##  4 MA                      9
    ##  5 MD                     12
    ##  6 NC                     12
    ##  7 NE                     10
    ##  8 NJ                     19
    ##  9 NY                      9
    ## 10 OH                      8
    ## 11 PA                      7
    ## 12 SC                      7
    ## 13 TX                     16
    ## 14 WA                     10

In 2002, there were 6 states that were observed at 7 or more locations.
PA was observed at 10 locations, NJ and MA were observed at 8 locations,
and CT, FL, and NC were observed at 7 locations In 2010, there were 14
states that were observed at 7 or more locations. FL, which was only
observed in 7 locations in 2002, was observed at 41 locations in 2010,
more than any other state. The others that were observed in 7 or more in
2002 were all also observed for 7 or more in 2010 except for
CT.

#### 2\. Construct a dataset that is limited to Excellent responses, and contains, year, state, and a variable that averages the data\_value across locations within a state. Make a “spaghetti” plot of this average value over time within a state (that is, make a plot showing a line for each state across years – the geom\_line geometry and group aesthetic will help).

``` r
brfss %>%
  filter(response == "Excellent") %>%
  filter(!is.na(percent_responded)) %>%
  group_by(year,state) %>%
  summarise(percent_excellent = mean(percent_responded)) %>%
  ggplot(aes(x=year,y=percent_excellent,color=state)) + 
  geom_line(aes(group = state))
```

![](p8105_hw3_bsr2136_files/figure-gfm/Problem%202.2-1.png)<!-- -->

The state (location) that consistently has close to the highest percent
responding with excellent is DC (which is not techincally a state), and
the state that consistently has close to the lowest percent responding
with excellent is West Virginia. While there is a lot of movement (or
noise) over the years, states do not seem to dramatically switch ranks
in terms of percent responding excellent over
time.

#### 3\. Make a two-panel plot showing, for the years 2006, and 2010, distribution of data\_value for responses (“Poor” to “Excellent”) among locations in NY State.

``` r
brfss_2006 <- brfss %>%
  filter(year==2006 & state == "NY") %>%
  ggplot(aes(x=response,y=percent_responded)) + 
  geom_boxplot() + ggtitle("2006") + 
  scale_y_continuous(limits = c(0,45))

brfss_2010 <- brfss %>%
  filter(year==2010 & state == "NY") %>%
  ggplot(aes(x=response,y=percent_responded)) + 
  geom_boxplot() + ggtitle("2010") + 
  scale_y_continuous(limits = c(0,45))

gridExtra::grid.arrange(brfss_2006,brfss_2010, nrow=1)
```

![](p8105_hw3_bsr2136_files/figure-gfm/problem%202.3-1.png)<!-- -->

From 2006 to 2010, the amount of “Excellent” and “Very good” responses
incrased on average, while the amount of “Fair” responses decreased on
average. Also, the distribution of responses for “Poor” and “Good”
responses significantly changed from 2006 to 2010.

## Problem 3
